I"Ğ$<blockquote>
  <p><a href="/2020/02/02/0.magento-menu.html">Magento 2 å¼€å‘å†…å®¹ç›®å½•</a></p>
</blockquote>

<p>æœ¬æ–‡è®¨è®ºå¦‚ä½•æ·»åŠ æ§åˆ¶å°å‘½ä»¤ã€‚Magento 2 ä½¿ç”¨å‘½ä»¤è¡Œå¯ä»¥å¿«é€Ÿå®ç°ä¸€äº›æ“ä½œï¼š</p>

<ul>
  <li>å®‰è£… Magento ï¼ˆç›¸å…³çš„è¿˜æœ‰åˆ›å»ºã€æ›´æ–°æ•°æ®è¡¨ï¼Œæ·»åŠ æˆ–å‘å¸ƒé…ç½®æ–‡ä»¶ç­‰ï¼‰</li>
  <li>æ¸…ç¼“å­˜</li>
  <li>ç®¡ç†ç´¢å¼•ï¼Œé‡å»ºç´¢å¼•</li>
  <li>åˆ›å»ºç¿»è¯‘æ–‡ä»¶åŠè¯­è¨€åŒ…</li>
  <li>ç”Ÿæˆä¸å­˜åœ¨çš„ä¸€äº›ç±»å¦‚å·¥å‚ç±»å’Œæ’ä»¶çš„æ‹¦æˆªå™¨ï¼Œä¸ºå¯¹åƒç®¡ç†å™¨ç”Ÿæˆä¾èµ–æ³¨å…¥é…ç½®æ–‡ä»¶</li>
  <li>å‘å¸ƒé™æ€æ–‡ä»¶</li>
  <li>ç¼–è¯‘LESSåˆ°CSS</li>
</ul>

<p>å¼€å§‹ä¹‹å‰ç¡®ä¿ HelloWorld æ¨¡å—è¿˜åœ¨ï¼Œè¿™ä¸ªæ¨¡å—åœ¨å‰é¢ç« èŠ‚ä¹Ÿä¸€ç›´ä½¿ç”¨ã€‚ä¸‹é¢å¼€å§‹æ·»åŠ æˆ‘ä»¬è‡ªå®šä¹‰çš„å‘½ä»¤ï¼š</p>

<h2 id="ç¬¬ä¸€æ­¥åœ¨-dixml-å®šä¹‰å‘½ä»¤">ç¬¬ä¸€æ­¥ï¼šåœ¨ di.xml å®šä¹‰å‘½ä»¤</h2>

<p>åœ¨ di.xml æ–‡ä»¶ä¸­å¯ä»¥ä½¿ç”¨ name å±æ€§ä¸º <code class="language-plaintext highlighter-rouge">Magento\Framework\Console\CommandList</code> çš„ type èŠ‚ç‚¹å®šä¹‰å‘½ä»¤å‚æ•°ã€‚</p>

<p>æ–‡ä»¶ï¼š <code class="language-plaintext highlighter-rouge">app/code/Aqrun/HelloWorld/etc/di.xml</code></p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;type</span> <span class="na">name=</span><span class="s">"Magento\Framework\Console\CommandList"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;arguments&gt;</span>
        <span class="nt">&lt;argument</span> <span class="na">name=</span><span class="s">"commands"</span> <span class="na">xsi:type=</span><span class="s">"array"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">"exampleSayHello"</span> <span class="na">xsi:type=</span><span class="s">"object"</span><span class="nt">&gt;</span>Aqrun\HelloWorld\Console\Sayhello<span class="nt">&lt;/item&gt;</span>
        <span class="nt">&lt;/argument&gt;</span>
    <span class="nt">&lt;/arguments&gt;</span>
<span class="nt">&lt;/type&gt;</span>
</code></pre></div></div>

<p>ä»£ç ä¸­å®šä¹‰äº†ä¸€ä¸ªå‘½ä»¤ç±» Sayhelloã€‚å‘½ä»¤ç±»ä¸­ä¼šå®šä¹‰å‘½ä»¤è¡Œåç§°ï¼Œå¹¶å®ç° <code class="language-plaintext highlighter-rouge">execute()</code> æ–¹æ³•</p>

<h2 id="ç¬¬äºŒæ­¥åˆ›å»ºå‘½ä»¤ç±»">ç¬¬äºŒæ­¥ï¼šåˆ›å»ºå‘½ä»¤ç±»</h2>

<p>æ ¹æ®é…ç½®æ–‡ä»¶æˆ‘ä»¬åˆ›å»ºå¦‚ä¸‹ç±»</p>

<p>æ–‡ä»¶ï¼š <code class="language-plaintext highlighter-rouge">app/code/Aqrun/HelloWorld/Console/Sayhello.php</code></p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">namespace</span> <span class="nn">Aqrun\HelloWorld\Console</span><span class="p">;</span>

<span class="kn">use</span> <span class="nc">Symfony\Component\Console\Command\Command</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Symfony\Component\Console\Input\InputInterface</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Symfony\Component\Console\Output\OutputInterface</span><span class="p">;</span>

<span class="kd">class</span> <span class="nc">Sayhello</span> <span class="kd">extends</span> <span class="nc">Command</span>
<span class="p">{</span>
    <span class="k">protected</span> <span class="k">function</span> <span class="n">configure</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">setName</span><span class="p">(</span><span class="s1">'ç¤ºä¾‹ï¼šsayhello'</span><span class="p">);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">setDiscription</span><span class="p">(</span><span class="s1">'ç¤ºä¾‹å‘½ä»¤'</span><span class="p">);</span>
        <span class="k">parent</span><span class="o">::</span><span class="nf">configure</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">protected</span> <span class="k">function</span> <span class="n">execute</span><span class="p">(</span><span class="kt">InputInterface</span> <span class="nv">$input</span><span class="p">,</span> <span class="kt">OutputInterface</span> <span class="nv">$output</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$output</span><span class="o">-&gt;</span><span class="nf">writeln</span><span class="p">(</span><span class="s1">'ä½ å¥½ä¸–ç•Œ'</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>å‡½æ•°ä¸­å®ç°äº†ä¸¤ä¸ªæ–¹æ³•ï¼š</p>

<ul>
  <li>configure() å‡½æ•°ç”¨æ¥è®¾ç½®åç§°ã€æè¿°ã€å‘½ä»¤è¡Œå‚æ•°</li>
  <li>execute() å‡½æ•°ä¼šåœ¨æ§åˆ¶å°è°ƒç”¨å‘½ä»¤æ—¶æ‰§è¡Œ</li>
</ul>

<p>ç±»çš„å®šä¹‰å®Œæˆåæ¸…ç©ºç¼“å­˜ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>php magento list
</code></pre></div></div>

<p>å¯ä»¥è¾“å‡ºæ‰€æœ‰å¯ç”¨å‘½ä»¤ï¼Œæˆ‘ä»¬åˆšæ·»åŠ çš„è‡ªå®šä¹‰å‘½ä»¤ä¹Ÿåœ¨ï¼š</p>

<p><img src="/public/images/magento2/14-cli-list1.png" alt="14-cli-list1.png" /></p>

<p>ç°åœ¨å¯ä»¥åœ¨æ§åˆ¶å°è¿è¡Œ <code class="language-plaintext highlighter-rouge">php bin/magento example:sayhello</code>ï¼š</p>

<p><img src="/public/images/magento2/14-cli-list1-result.png" alt="14-cli-list1-result.png" /></p>

<p>æ¥ä¸‹æ¥å¯ä»¥ç»™å‘½ä»¤æ·»åŠ ä¸€äº›å‚æ•°ã€‚</p>

<p>ä»£ç å¦‚ä¸‹ï¼š</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="kn">namespace</span> <span class="nn">Aqrun\HelloWorld\Console</span><span class="p">;</span>

<span class="kn">use</span> <span class="nc">Symfony\Component\Console\Command\Command</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Symfony\Component\Console\Input\InputInterface</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Symfony\Component\Console\Output\OutputInterface</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Symfony\Component\Console\Input\InputOption</span><span class="p">;</span>

<span class="kd">class</span> <span class="nc">Sayhello</span> <span class="kd">extends</span> <span class="nc">Command</span>
<span class="p">{</span>

    <span class="k">const</span> <span class="no">NAME</span> <span class="o">=</span> <span class="s1">'name'</span><span class="p">;</span>

    <span class="k">protected</span> <span class="k">function</span> <span class="n">configure</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$options</span> <span class="o">=</span> <span class="p">[</span>
            <span class="k">new</span> <span class="nc">InputOption</span><span class="p">(</span><span class="k">self</span><span class="o">::</span><span class="no">NAME</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span><span class="nc">InputOption</span><span class="o">::</span><span class="no">VALUE_REQUIRED</span><span class="p">,</span> <span class="s1">'å§“å'</span><span class="p">)</span>
        <span class="p">];</span>

        <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">setName</span><span class="p">(</span><span class="s1">'example:sayhello'</span><span class="p">)</span>
            <span class="o">-&gt;</span><span class="nf">setDescription</span><span class="p">(</span><span class="s1">'ç¤ºä¾‹å‘½ä»¤'</span><span class="p">)</span>
            <span class="o">-&gt;</span><span class="nf">setDefinition</span><span class="p">(</span><span class="nv">$options</span><span class="p">);</span>
        <span class="k">parent</span><span class="o">::</span><span class="nf">configure</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">protected</span> <span class="k">function</span> <span class="n">execute</span><span class="p">(</span><span class="kt">InputInterface</span> <span class="nv">$input</span><span class="p">,</span> <span class="kt">OutputInterface</span> <span class="nv">$output</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$name</span> <span class="o">=</span> <span class="nv">$input</span><span class="o">-&gt;</span><span class="nf">getOption</span><span class="p">(</span><span class="k">self</span><span class="o">::</span><span class="no">NAME</span><span class="p">))</span> <span class="p">{</span>
            <span class="nv">$output</span><span class="o">-&gt;</span><span class="nf">writeln</span><span class="p">(</span><span class="s1">'ä½ å¥½'</span> <span class="mf">.</span> <span class="nv">$name</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nv">$output</span><span class="o">-&gt;</span><span class="nf">writeln</span><span class="p">(</span><span class="s1">'ä½ å¥½ä¸–ç•Œ'</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>ä»£ç ä¸­æˆ‘ä»¬åœ¨ configure() å‡½æ•°ä¸­å®šä¹‰äº†å‘½ä»¤è¡Œå‚æ•° nameï¼Œå¹¶åœ¨ execute() æ–¹æ³•ä¸­è·å–å®ƒçš„å€¼ã€‚æ¸…ç©ºç¼“å­˜ç„¶åè¿è¡Œ <code class="language-plaintext highlighter-rouge">php bin/magento example:sayhello --name=Aqrun</code> å°±ä¼šè¾“å‡º â€œä½ å¥½Aqrunâ€ã€‚</p>
:ET