I"¼*<blockquote>
  <p><a href="/2020/02/02/0.magento-menu.html">Magento 2 å¼€å‘å†…å®¹ç›®å½•</a></p>
</blockquote>

<p>æœ¬æ–‡ä¸»è¦æè¿°å¦‚ä½•åˆ›å»ºä¸€ä¸ªæœ€ç®€å•çš„æ¨¡å—ã€‚</p>

<p>æ¨¡å— (Module) ä¹Ÿå°±æ˜¯ä¸€ä¸ªåŒ…å«ç‰¹å®šä¸šåŠ¡å­ç›®å½•ï¼ˆ<code class="language-plaintext highlighter-rouge">åŒºå—blocks</code>ã€<code class="language-plaintext highlighter-rouge">æ§åˆ¶å™¨controllers</code>ã€<code class="language-plaintext highlighter-rouge">æ¨¡å‹models</code>ã€<code class="language-plaintext highlighter-rouge">å¸®åŠ©æ–‡ä»¶helper</code>ã€<code class="language-plaintext highlighter-rouge">é…ç½®ç›¸å…³etc</code>ï¼‰çš„æ–‡ä»¶å¤¹ã€‚<code class="language-plaintext highlighter-rouge">etc</code> ç›®å½•åŒ…å«æœ‰åå°æƒé™æ§åˆ¶ï¼ˆadmin aclï¼‰ã€åå°èœå•é…ç½®ã€å…¶å®ƒé…ç½®æ–‡ä»¶ã€‚æ¨¡å—ä¸€èˆ¬åœ¨ <code class="language-plaintext highlighter-rouge">app/code</code> ç›®å½•ï¼Œå…¨è·¯å¾„: <code class="language-plaintext highlighter-rouge">app/code/&lt;Vendor&gt;/&lt;ModuleName&gt;</code>ï¼Œ Vendor æ˜¯ä¼ä¸šåç§°å¦‚ Baiduã€‚ä¸‹é¢åˆ›å»ºä¸€ä¸ªå¯ä»¥æ‰§è¡Œçš„æ¨¡å—å¹¶æ˜¾ç¤º â€œHello Worldâ€ã€‚</p>

<h2 id="åŸºç¡€éƒ¨åˆ†ä¸»è¦å†…å®¹æœ‰">åŸºç¡€éƒ¨åˆ†ä¸»è¦å†…å®¹æœ‰</h2>

<ul>
  <li>åˆ›å»ºæ§åˆ¶å™¨ï¼ˆControllerï¼‰</li>
  <li>åˆ›å»ºæ¨¡å‹ï¼ˆModel)</li>
  <li>åˆ›å»ºè§†å›¾ï¼ˆView)</li>
  <li>åå°èœå•ï¼ˆAdmin Menuï¼‰</li>
  <li>å‚æ•°é…ç½®ï¼ˆConfigurationï¼‰</li>
  <li>åå°ç½‘æ ¼ï¼ˆGridï¼‰</li>
</ul>

<h2 id="åˆ›å»º-hello-world-æ¨¡å—">åˆ›å»º Hello World æ¨¡å—</h2>

<p>åˆ›å»ºæ¨¡å—éœ€è¦å®Œæˆå¦‚ä¸‹å‡ æ­¥ï¼š</p>

<ol>
  <li>åˆ›å»ºæ¨¡å—ç›®å½•</li>
  <li>æ·»åŠ  <code class="language-plaintext highlighter-rouge">etc/module.xml</code> æ–‡ä»¶</li>
  <li>æ·»åŠ  <code class="language-plaintext highlighter-rouge">etc/registration.php</code> æ–‡ä»¶</li>
  <li>å¯ç”¨æ¨¡å—</li>
</ol>

<h3 id="ç¬¬ä¸€æ­¥-æ–°å»ºæ¨¡å—æ–‡ä»¶å¤¹">ç¬¬ä¸€æ­¥ï¼š æ–°å»ºæ¨¡å—æ–‡ä»¶å¤¹</h3>

<p>æ¨¡å—å‘½åæ ¼å¼ <code class="language-plaintext highlighter-rouge">VendorName_ModuleName</code>ã€‚å‰ä¸€éƒ¨åˆ†æ˜¯å…¬å¸ååé¢æ˜¯æ¨¡å—åï¼šå¦‚ï¼š<code class="language-plaintext highlighter-rouge">Magento_HelloWorld</code>ã€ <code class="language-plaintext highlighter-rouge">Aqrun_PdfInvoice</code>ã€‚æˆ‘ä»¬åˆ›å»ºå¦‚ä¸‹ç›®å½•ï¼š</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>app/code/Aqrun/HelloWorld
</code></pre></div></div>
<h3 id="ç¬¬äºŒæ­¥æ·»åŠ -etcmodulexml-æ–‡ä»¶">ç¬¬äºŒæ­¥ï¼šæ·»åŠ  <code class="language-plaintext highlighter-rouge">etc/module.xml</code> æ–‡ä»¶</h3>

<p>ç„¶åéœ€è¦æ–°å»º <code class="language-plaintext highlighter-rouge">etc</code> ç›®å½•å¹¶æ·»åŠ  <code class="language-plaintext highlighter-rouge">module.xml</code> æ–‡ä»¶</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>app/code/Aqrun/HelloWorld/etc/module.xml
</code></pre></div></div>

<p>å†…å®¹ï¼š</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0"?&gt;</span>
<span class="nt">&lt;config</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="na">xsi:noNamespaceSchemaLocation=</span><span class="s">"urn:magento:framework:Module/etc/module.xsd"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;module</span> <span class="na">name=</span><span class="s">"Aqrun_HelloWorld"</span> <span class="na">setup_version=</span><span class="s">"1.0.0"</span><span class="nt">&gt;</span>
    <span class="err">&lt;</span>/module
<span class="nt">&lt;/config&gt;</span>
</code></pre></div></div>

<h3 id="ç¬¬ä¸‰æ­¥æ·»åŠ -etcregistrationphp-æ–‡ä»¶">ç¬¬ä¸‰æ­¥ï¼šæ·»åŠ  <code class="language-plaintext highlighter-rouge">etc/registration.php</code> æ–‡ä»¶</h3>

<p>è¿™ä¸€æ­¥æ·»åŠ  <code class="language-plaintext highlighter-rouge">registration.php</code> æ–‡ä»¶</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>app/code/Aqrun/HelloWorld/registration.php
</code></pre></div></div>

<p>å†…å®¹ï¼š</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="kn">use</span> <span class="nc">Magento\Framework\Component\ComponentRegistrar</span><span class="p">;</span>

<span class="nc">ComponentRegistrar</span><span class="o">::</span><span class="nf">register</span><span class="p">(</span>
    <span class="nc">ComponentRegistrar</span><span class="o">::</span><span class="no">MODULE</span><span class="p">,</span>
    <span class="s1">'Aqrun_HelloWorld'</span><span class="p">,</span>
    <span class="k">__DIR__</span>
<span class="p">);</span>
</code></pre></div></div>

<h3 id="ç¬¬å››æ­¥å¯ç”¨æ¨¡å—">ç¬¬å››æ­¥ï¼šå¯ç”¨æ¨¡å—</h3>

<p>å®Œæˆç¬¬ä¸‰æ­¥æ—¶æˆ‘ä»¬å·²ç»åˆ›å»ºäº† HelloWorld æ¨¡å—ï¼Œè¿™ä¸€æ­¥æˆ‘ä»¬å¯ç”¨å®ƒã€‚</p>

<p>ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å¯ä»¥æŸ¥çœ‹åˆ°æˆ‘ä»¬æ¨¡å—å¤„äºæœªå¯ç”¨ï¼ˆDisabledï¼‰åˆ—è¡¨</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>php bin/magento module:status
</code></pre></div></div>

<p>æœªå¯ç”¨æ¨¡å—åˆ—è¡¨ä¼šæ˜¾ç¤ºå‡ºï¼š  <code class="language-plaintext highlighter-rouge">Aqrun_HelloWorld</code></p>

<p>å¯ç”¨æŒ‡å®šæ¨¡å—è¿è¡Œï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>php bin/magento module:enable Aqrun_HelloWorld
</code></pre></div></div>
<p>å¦ä¸€ç§å¯ç”¨æ¨¡å—çš„æ–¹å¼æ˜¯ç¼–è¾‘ <code class="language-plaintext highlighter-rouge">app/etc/config.php</code> æ–‡ä»¶ï¼Œ æŠŠä½ çš„æ¨¡å—åŠ åˆ°è¿™ä¸ªæ–‡ä»¶çš„åˆ—è¡¨é‡Œï¼š</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mf">...</span>
<span class="s1">'Aqrun_HelloWorld'</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
<span class="mf">...</span>
</code></pre></div></div>

<p>å®Œæˆè¿™ä¸€æ­¥ä¹‹åæµè§ˆå™¨æ‰“å¼€ä½ çš„ç½‘ç«™æˆ–è®¸ä¼šæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ï¼Œå¯ä»¥è¿è¡Œå¦‚ä¸‹å‘½ä»¤æ›´æ–°æ¨¡å—</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>php bin/magento setup:upgrade
</code></pre></div></div>

<p>åˆ·æ–°æµè§ˆå™¨å¦‚æœé¡µé¢å†…å®¹é”™ä¹±æ²¡æœ‰æ ·å¼æˆ–ä»¥æ‰§è¡Œé™æ€å†…å®¹å‘å¸ƒå‘½ä»¤</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>php bin/magento setup:static-content:deploy
</code></pre></div></div>

<p>æ¥ä¸‹æ¥æ·»åŠ ä¸€ä¸ªæ§åˆ¶å™¨æµ‹è¯•æ¨¡å—</p>

<p>æ·»åŠ æ§åˆ¶å™¨ä¹‹å‰éœ€è¦è¿˜è¦ç»™æ¨¡å—å¢åŠ ä¸€ä¸ªè·¯ç”±é…ç½®</p>

<p>Magentoçš„è·¯ç”±æ ¼å¼æœ‰ä¸‰ä¸ªéƒ¨åˆ†ï¼šå‰ç«¯åç§°ï¼ˆFrontnameï¼‰ã€æ§åˆ¶å™¨ï¼ˆControllerï¼‰ã€åŠ¨ä½œï¼ˆActionï¼‰ã€‚å¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://mag.dev/index.php/frontname/controller/action
</code></pre></div></div>

<p>è·¯ç”±é…ç½®ä¿¡æ¯åœ¨ <code class="language-plaintext highlighter-rouge">routes.xml</code> æ–‡ä»¶ä¸­ <code class="language-plaintext highlighter-rouge">app/code/Aqrun/HelloWorld/etc/frontend/routes.xml</code></p>

<p>è¿™æ˜¯å‰ç«¯ç”±é…ç½®åœ¨ <code class="language-plaintext highlighter-rouge">frontend/</code> ç›®å½•ï¼Œåå°è·¯ç”±åœ¨ <code class="language-plaintext highlighter-rouge">adminhtml/</code> ç›®å½•</p>

<p>å†…å®¹å¦‚ä¸‹ï¼š</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" ?&gt;</span>
<span class="nt">&lt;config</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="na">xsi:noNamespaceSchemaLocation=</span><span class="s">"urn:magento:framework:App/etc/routes.xsd"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;router</span> <span class="na">id=</span><span class="s">"standard"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;route</span> <span class="na">frontName=</span><span class="s">"helloworld"</span> <span class="na">id=</span><span class="s">"helloworld"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;module</span> <span class="na">name=</span><span class="s">"Aqrun_HelloWorld"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/route&gt;</span>
    <span class="nt">&lt;/router&gt;</span>
<span class="nt">&lt;/config&gt;</span>
</code></pre></div></div>

<p>è¿™ä¸ªè·¯ç”±é…ç½®çš„URLè·¯å¾„å°±ä¼šæ˜¯ <code class="language-plaintext highlighter-rouge">http://mag.dev/helloworld/*</code></p>

<p>ç„¶åç»§ç»­æ·»åŠ æ§åˆ¶å™¨å’ŒåŠ¨ä½œ</p>

<p>æ–°å»ºè·¯å¾„åŠæ–‡ä»¶ï¼š<code class="language-plaintext highlighter-rouge">app/code/Aqrun/HelloWorld/Controller/Index/Test.php</code></p>

<p>ä»£ç ï¼š</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">namespace</span> <span class="nn">Aqrun\HelloWorld\Controller\Index</span><span class="p">;</span>

<span class="kd">class</span> <span class="nc">Test</span> <span class="k">extends</span> <span class="err">\</span><span class="nc">Magento\Framework\App\Action\Action</span>
<span class="p">{</span>
    <span class="k">protected</span> <span class="nv">$_pageFactory</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="n">__construct</span><span class="p">(</span>
        <span class="err">\</span><span class="nc">Magento\Framework\App\Action\Context</span> <span class="nv">$context</span><span class="p">,</span>
        <span class="err">\</span><span class="nc">Magento\Framework\View\Result\PageFactory</span> <span class="nv">$pageFactory</span>
    <span class="p">){</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">_pageFactory</span> <span class="o">=</span> <span class="nv">$pageFactory</span><span class="p">;</span>
        <span class="k">return</span> <span class="k">parent</span><span class="o">::</span><span class="nf">__construct</span><span class="p">(</span><span class="nv">$context</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="n">execute</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">"Hello World"</span><span class="p">;</span>
        <span class="k">exit</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>ç„¶åæ‰§è¡Œ <code class="language-plaintext highlighter-rouge">php bin/magento cache:clean</code></p>

<p>æµè§ˆå™¨æ‰“å¼€é“¾æ¥ <code class="language-plaintext highlighter-rouge">http://mag.dev/helloworld/index/test</code> æµ‹è¯•ç»“æœ</p>

<p>å°±ä¼šæ˜¾ç¤º Hello Worldã€‚ä¸‹ä¸€éƒ¨åˆ†å†…å®¹äº†è§£å¦‚ä½•åˆ›å»ºå®Œæ•´çš„æ§åˆ¶å™¨</p>
:ET