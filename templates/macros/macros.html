{%- macro title_post(page, config) %}
        <h1><a href="{{ page.permalink | safe }}{%- if config.extra.uglyurls %}index.html{%- endif %}">{{ page.title }}</a></h1>
{%- endmacro title_post %}

{%- macro get_category_name(name) -%}
    {%- if name == "rust" -%}
        Rust 语言
    {%- elif name == "backend" -%}
        后端开发
    {%- elif name == "frontend" -%}
        前端开发
    {%- elif name == "server" -%}
        服务器
    {%- elif name == "diary" -%}
        每日随笔
    {%- else -%}
        {{ name }}
    {%- endif -%}
{%- endmacro get_category_name %}

{#- 首页文章列表模块 #}
{%- macro generate_index_posts_block(block_name, posts) -%}
<div class="oic-index-section-block">
    <h2 class="oic-block-name">
        {{ macros::get_category_name(name=block_name) }}
    </h2>
    {%- for post in posts | slice(end=5) %}
    <p>
        <a href="{{ post.permalink | safe }}">{{ post.title }}</a>
        -
        <time datetime="{{ post.date }}">
            {{ post.date | date(format="%F") }}
        </time>
    </p>
    {%- endfor %}
</div>
{%- endmacro generate_index_posts_block -%}

{%- macro wx_pic(img) -%}
{%- if img -%}
<noscript>
    <div id="wx_pic" style="margin:0 auto;display:none;">
        {#- pic300.jpg -#}
        <img src="{{ img | safe }}" />
    </div>
</noscript>
{%- endif -%}
{%- endmacro wx_pic -%}

{%- macro meta_post(page, config) %}
        <span{%- if config.extra.meta_post.size %} class="{{ config.extra.meta_post.size }}"{% endif %}>

        {#- Author #}
        {%- if page.taxonomies.authors and config.taxonomies %}
          {%- for author in page.taxonomies.authors %}
          {%- if author_flag %}, {% endif %}
          <a href="{{ get_taxonomy_url(kind='authors', name=author) | safe }}{%- if config.extra.uglyurls %}index.html{%- endif %}">{{ author }}</a>
          {%- set_global author_flag = true %}
          {%- endfor %}
        {%- elif page.extra.authors and config.extra.meta_post.author %}
          {%- if config.extra.icon_author %}<i class="{{ config.extra.icon_author }}"></i> {% endif %}
          {%- for author in page.extra.authors %}
          {%- if author_flag %}, {% endif %} {{ author }}
          {%- set_global author_flag = true %}
          {%- endfor %}
        {%- elif config.extra.author and config.extra.meta_post.author %}
          {%- if config.extra.icon_author %}<i class="{{ config.extra.icon_author }}"></i> {% endif %} {{ config.extra.author }}
        {%- endif %}

          {#- divider #}
          {%- if config.extra.meta_post.author %}
          {%- if config.extra.meta_post.readtime or config.extra.meta_post.date or config.extra.meta_post.categories_tags %}
          {%- if config.extra.meta_post.divider %}<span class="hpad">{{ config.extra.meta_post.divider | safe }}</span>{%- else %} &nbsp; {%- endif %}
          {%- endif %}
          {%- endif %}

        {#- ReadTime #}
          {%- if config.extra.meta_post.readtime %} {%- if config.extra.icon_read %}<i class="{{ config.extra.icon_read }}"></i> {% endif %} {{ page.reading_time }} {{ config.extra.meta_post.readstring | default(value="min") }}
          {#- divider #}
          {%- if config.extra.meta_post.date or config.extra.meta_post.categories_tags %}
          {%- if config.extra.meta_post.divider %}<span class="hpad">{{ config.extra.meta_post.divider | safe }}</span>{%- else %} &nbsp; {%- endif %}{%- endif %}{%- endif %}

        {#- Date #}
          {%- if config.extra.meta_post.date %} {%- if config.extra.icon_date %}<i class="{{ config.extra.icon_date }}"></i> {% endif %} {{ page.date | date(format="%Y-%m-%d") }}
          {#- divider #}
          {%- if config.extra.meta_post.categories_tags %}
          {%- if config.extra.meta_post.divider %}<span class="hpad">{{ config.extra.meta_post.divider | safe }}</span>{%- else %} &nbsp; {%- endif %}{%- endif %}{% endif %}

        {#- Categories #}
          {%- if page.taxonomies.categories %}
          {%- if config.extra.icon_info %}
            <i class="{{ config.extra.icon_info }}"></i>
          {% endif %}
          [{% for cat in page.taxonomies.categories %}
            {%- if cat != "article" -%}
            <a href="{{ get_taxonomy_url(kind='categories', name=cat) | safe }}{%- if config.extra.uglyurls %}index.html{%- endif %}">
                {{ macros::get_category_name(name=cat) }}
            </a>
            {%- endif -%}
          {% endfor %}]
          {% endif %}

        {#- Tags #}
          {%- if page.taxonomies.tags %} {%- for tag in page.taxonomies.tags %} #<a href="{{ get_taxonomy_url(kind='tags', name=tag) | safe }}{%- if config.extra.uglyurls %}index.html{%- endif %}">{{ tag }}</a> {% endfor -%}{%- endif %}</span>
{%- endmacro meta_post %}

{%- macro title_index(page, config) %}
        <h1>{% if config.extra.title_size_index %}<span class="{{ config.extra.title_size_index }}">{% endif %}<a href="{{ page.permalink | safe }}{%- if config.extra.uglyurls %}index.html{%- endif %}">{{ page.title }}</a>{% if config.extra.title_size_index %}</span>{% endif %}</h1>
{%- endmacro title_index %}


{%- macro meta_index(page, config) %}
        <span{%- if config.extra.meta_index.size %} class="{{ config.extra.meta_index.size }}"{% endif %}>

        {#- Author #}
        {%- if page.taxonomies.authors and config.taxonomies %}
          {%- for author in page.taxonomies.authors %}
          {%- if author_flag %}, {% endif %}
          <a href="{{ get_taxonomy_url(kind='authors', name=author) | safe }}{%- if config.extra.uglyurls %}index.html{%- endif %}">{{ author }}</a>
          {%- set_global author_flag = true %}
          {%- endfor %}
        {%- elif page.extra.authors and config.extra.meta_index.author %}
          {%- if config.extra.icon_author %}<i class="{{ config.extra.icon_author }}"></i> {% endif %}
          {%- for author in page.extra.authors %}
          {%- if author_flag %}, {% endif %} {{ author }}
          {%- set_global author_flag = true %}
          {%- endfor %}
        {%- elif config.extra.author and config.extra.meta_index.author %}
          {%- if config.extra.icon_author %}<i class="{{ config.extra.icon_author }}"></i> {% endif %} {{ config.extra.author }}
        {%- endif %}

          {#- divider #}
          {%- if config.extra.meta_index.author %}
          {%- if config.extra.meta_index.readtime or config.extra.meta_index.date or config.extra.meta_index.categories_tags %}
          {%- if config.extra.meta_index.divider %}<span class="hpad">{{ config.extra.meta_index.divider | safe }}</span>{%- else %} &nbsp; {%- endif %}
          {%- endif %}
          {%- endif %}

        {#- ReadTime #}
          {%- if config.extra.meta_index.readtime %} {%- if config.extra.icon_read %}<i class="{{ config.extra.icon_read }}"></i> {% endif %} {{ page.reading_time }} {{ config.extra.meta_index.readstring | default(value="min") }}
          {#- divider #}
          {%- if config.extra.meta_index.date or config.extra.meta_index.categories_tags %}
          {%- if config.extra.meta_index.divider %}<span class="hpad">{{ config.extra.meta_index.divider | safe }}</span>{%- else %} &nbsp; {%- endif %}{%- endif %}{%- endif %}

        {#- Date #}
          {%- if config.extra.meta_index.date %} {%- if config.extra.icon_date %}<i class="{{ config.extra.icon_date }}"></i> {% endif %} {{ page.date | date(format="%Y-%m-%d") }}
          {#- divider #}
          {%- if config.extra.meta_index.categories_tags %}
          {%- if config.extra.meta_index.divider %}<span class="hpad">{{ config.extra.meta_index.divider | safe }}</span>{%- else %} &nbsp; {%- endif %}{%- endif %}{% endif %}

        {#- Categories #}
          {%- if page.taxonomies.categories %}
            {%- if config.extra.icon_info %}
              <i class="{{ config.extra.icon_info }}"></i>
            {% endif %}
            [
            {% for cat in page.taxonomies.categories %}
              {%- if cat != "article" -%}
              <a href="{{ get_taxonomy_url(kind='categories', name=cat) | safe }}{%- if config.extra.uglyurls %}index.html{%- endif %}">
                  {{ macros::get_category_name(name=cat) }}
              </a>
              {%- endif -%}
            {% endfor %}
            ]
          {% endif %}

        {#- Tags #}
          {%- if page.taxonomies.tags %} {%- for tag in page.taxonomies.tags %} #<a href="{{ get_taxonomy_url(kind='tags', name=tag) | safe }}{%- if config.extra.uglyurls %}index.html{%- endif %}">{{ tag }}</a> {% endfor -%}{%- endif %}</span>
{%- endmacro meta_index %}




{%- macro footer(page) %}
{%- if page.reading_time %}
{%- if page.reading_time > 2 %}
<p><b><a href="#">返回顶部</a></b></p>
{%- endif %}
{%- endif %}
{%- endmacro footer %}


{%- macro pagination(paginator, config)%}
  {%- if paginator.number_pagers > 1 %}
            {%- if paginator.number_pagers <= 5 %}  {# 5 or less pager is simple, just display all 5 #}
                {%- set start = 1 %}
                {%- set end = paginator.number_pagers %}
            {%- endif %}

            {%- if paginator.number_pagers > 5 %}

                {%- if paginator.current_index >= 3 %}                {# Check if the first number will be 1 or not #}
                    {%- set start = paginator.current_index - 2 %}    {# Set the start number #}
                    {%- if paginator.number_pagers - paginator.current_index < 2 %}  {# the last two pages your no longer centered with equal pages start and end #}
                        {%- set difference = paginator.number_pagers - paginator.current_index %}
                        {%- set compensation =  1 - difference %}
                        {%- set start = paginator.current_index - 3 - compensation %}  {# however many pages are missing on the end, add offset to start #}
                    {%- endif %}
                {%- else %}
                    {%- set start = 1 %}
                {%- endif %}

                {%- if paginator.number_pagers >= paginator.current_index + 2 %}  {# Check if the last page is beyond our range #}
                    {%- set end = paginator.current_index + 2 %}  {# End is beyond our range so we can safely set it to our range #}
                    {%- if paginator.current_index <= 3 %}  {# check offset start, if on page 1 or 2 then set the end to page 5 #}
                        {%- set end = 5 %}
                    {%- endif %}
                {%- else %}
                    {%- set end = paginator.number_pagers %}
                {%- endif %}
            {%- endif %}
      <nav>
        <ul>
        {%- if paginator.previous -%}
          <li><a class="on outp" href="{{ paginator.first | safe }}{%- if config.extra.uglyurls %}index.html{%- endif %}" title="First Page">
          {%- if config.extra.icon_first -%}<i class="{{ config.extra.icon_first }}" alt="First Page"></i>
          {%- else -%}&#10096;
          {%- endif -%}
          </a></li>
        {%- else -%}
          <li><span class="off outp">
          {%- if config.extra.icon_first -%}<i class="{{ config.extra.icon_first }}" alt="First Page"></i>
          {%- else -%}&#10096;
          {%- endif -%}
          </span></li>
        {%- endif -%}

        {%- if paginator.previous -%}
          <li><a class="on outp" href="{{ paginator.previous | safe }}{%- if config.extra.uglyurls %}index.html{%- endif %}" title="Previous Page">
          {%- if config.extra.icon_prev -%}<i class="{{ config.extra.icon_prev }}" alt="Previous Page"></i>
          {%- else -%}&#10092;
          {%- endif -%}
          </a></li>
        {%- else -%}
          <li><span class="off outp">
          {%- if config.extra.icon_prev -%}<i class="{{ config.extra.icon_prev }}" alt="Previous Page"></i>
          {%- else -%}&#10092;
          {%- endif -%}
          </span></li>
        {%- endif -%}

        {%- for i in range(start=start, end=end+1) -%}
          <li class="inp">
            {%- if i == paginator.current_index -%}
            <a class="on cnav" href="#">{{i}}</a>
            {%- elif i > 1 -%}
            <a class="on" href="{{ paginator.base_url | safe }}{{ i ~ '/' }}{%- if config.extra.uglyurls %}index.html{%- endif %}">{{i}}</a>
            {%- else -%}
            <a class="on" href="{{ paginator.first | safe }}{%- if config.extra.uglyurls %}index.html{%- endif %}">{{ i }}</a>
            {%- endif -%}
          </li>
        {%- endfor -%}

        {%- if paginator.next -%}
          <li><a class="on outp" href="{{ paginator.next | safe }}{%- if config.extra.uglyurls %}index.html{%- endif %}" title="Next Page">
          {%- if config.extra.icon_next -%}<i class="{{ config.extra.icon_next }}" alt="Next Page"></i>
          {%- else -%}&#10093;
          {%- endif -%}
          </a></li>
        {%- else -%}
          <li><span class="off outp">
          {%- if config.extra.icon_next -%}<i class="{{ config.extra.icon_next }}" alt="Next Page"></i>
          {%- else -%}&#10093;
          {%- endif -%}
          </span></li>
        {%- endif -%}

        {%- if paginator.next -%}
          <li><a class="on outp" href="{{ paginator.last | safe }}{%- if config.extra.uglyurls %}index.html{%- endif %}" title="Last Page">
          {%- if config.extra.icon_last -%}<i class="{{ config.extra.icon_last }}" alt="Last Page"></i>
          {%- else -%}&#10097;
          {%- endif -%}
          </a></li>
        {%- else -%}
          <li><span class="off outp">
          {%- if config.extra.icon_last -%}<i class="{{ config.extra.icon_last }}" alt="Last Page"></i>
          {%- else -%}&#10097;
          {%- endif -%}
          </span></li>
        {%- endif -%}
        </ul>
      </nav>
  {%- endif %}
{%- endmacro %}
